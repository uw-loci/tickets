<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #57 (Execute ImageJ macros on virtual stacks)
     â€“ LOCI Software
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/trac/software/ticket/57">Ticket #57</a>
          <span class="status">(closed enhancement: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2007-03-20T09:50:31-05:00</p>
    <p>Last modified 2008-08-15T14:06:16-05:00</p>
  </div>
  <h2 class="summary searchable">Execute ImageJ macros on virtual stacks</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        curtis
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        melissa
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              minor
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              plugins
        </td>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              major
        </td>
    </tr><tr>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr><tr>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2008-07-02 19:49:09+00:00">
        (last modified by curtis)
      </span>
    </h3>
    <div class="searchable">
      <p>
Currently, when working with an ImageJ virtual stack, performing any command that alters image planes (e.g., Process&gt;Smooth) affects only the currently displayed image plane. As long as that plane remains in the cache, it will remain altered, but as soon as the plane is dropped from memory (e.g., if the user navigates to a new plane too far away from the original plane), the action is lost, since the plane is recached from disk.
</p>
<p>
One solution to this issue is to take advantage of ImageJ's comprehensive macro language functionality, recording each command into a "preprocessing macro" that is dynamically applied to planes as the commands occur, and as new planes are cached. To the user, the behavior would seem nearly identical to a normal image window, except for potential delays from CPU-intensive image processing operations.
</p>
<p>
At one point the codebase contained an initial implementation of this idea, but it was not yet robust. The macro recorder window sometimes popped up unexpectedly, so the preprocessing macro logic has been commented out for now (<a class="changeset" href="/trac/software/changeset/2463" title="Insert Thread.sleep call in MacroManager thread to avoid 100% CPU usage. ...">r2463</a>).
</p>
<p>
This type of functionality would be useful for ImageJ in general, not just as part of the LOCI plugins, and as such a comprehensive implementation would make the most sense, rather than merely within the context of the LOCI plugins.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2007-10-11T12:57:51-05:00 by melissa
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Priority</strong>
        changed from <em>minor</em> to <em>major</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2008-07-02T14:49:09-05:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Priority</strong>
        changed from <em>major</em> to <em>minor</em>
    </li><li>
      <strong>Component</strong>
        changed from <em>browser</em> to <em>plugins</em>
    </li><li>
      <strong>Description</strong>
        modified
    </li><li>
      <strong>Severity</strong>
        set to <em>major</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2008-08-15T14:06:16-05:00 by melissa
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This feature is mostly functional in <a class="changeset" href="/trac/software/changeset/4311" title="First cut at applying macros to virtual stacks.  Has not been thoroughly ...">r4311</a>.  Needs a bit more work to get it working with the data browser, and will need to be tested more with more complex macros.
</p>
<p>
Rather than working with the macro recorder, there is a new class called "RecordedImageProcessor".  As the name implies, this is used to record each ImageProcessor method that gets called - this method list is saved in BFVirtualStack, and re-executed the next time the slice is retrieved from the cache (or from disk).
</p>

    </div>

              </div>
          </div>
        </div>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/trac/software/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/software/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the LOCI software web site at<br /><a href="http://loci.wisc.edu/software/">http://loci.wisc.edu/software/</a></p>
    </div>
  </body>
</html>
