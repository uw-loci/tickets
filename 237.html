<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #237 (Image planes from LegacyQTReader can no longer be displayed)
     â€“ LOCI Software
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="notice" style="width: 58em; max-width: 100%; margin-left: auto; margin-right: auto; border: 1px solid black; margin-bottom: 2em">
      <table>
        <tr>
          <td style="font-size: 72px; color: firebrick; padding: 0 10px 0 10px">&#9888;</td>
          <td>
            <p style="margin: 0.4em">
            NOTICE! This is a static HTML version of a legacy LOCI Software ticket.
            </p>
            <p style="margin: 0.4em">
            LOCI projects are now located
            <a href="https://github.com/uw-loci">on GitHub</a>.
            The Bio-Formats project can be found
            <a href="https://github.com/openmicroscopy/bioformats">here</a>.
            </p>
          </td>
        </tr>
      </table>
    </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="237.html">Ticket #237</a>
          <span class="status">(closed defect: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2008-02-11T12:11:29-06:00</p>
    <p>Last modified 2008-02-14T09:27:48-06:00</p>
  </div>
  <h2 class="summary searchable">Image planes from LegacyQTReader can no longer be displayed</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        curtis
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        melissa
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              critical
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              bio-formats
        </td>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              critical
        </td>
    </tr><tr>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr><tr>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
Attempting to read <tt>data/quicktime/curtis/mri-cinepak.mov</tt> on a Windows system, the following exception occurs when attempting to paint the image in the Image Viewer:
</p>
<pre class="wiki">Exception in thread "AWT-EventQueue-0" java.lang.ArrayIndexOutOfBoundsException: 42036
        at java.awt.image.DataBufferInt.getElem(Unknown Source)
        at java.awt.image.ComponentSampleModel.getDataElements(Unknown Source)
        at java.awt.image.Raster.getDataElements(Unknown Source)
        at sun.java2d.loops.OpaqueCopyAnyToArgb.Blit(Unknown Source)
        at sun.java2d.loops.GraphicsPrimitive.convertFrom(Unknown Source)
        at sun.java2d.loops.GraphicsPrimitive.convertFrom(Unknown Source)
        at sun.java2d.loops.MaskBlit$General.MaskBlit(Unknown Source)
        at sun.java2d.loops.Blit$GeneralMaskBlit.Blit(Unknown Source)
        at sun.java2d.pipe.DrawImage.blitSurfaceData(Unknown Source)
        at sun.java2d.pipe.DrawImage.renderImageCopy(Unknown Source)
        at sun.java2d.pipe.DrawImage.copyImage(Unknown Source)
        at sun.java2d.pipe.DrawImage.copyImage(Unknown Source)
        at sun.java2d.SunGraphics2D.drawImage(Unknown Source)
        at sun.java2d.SunGraphics2D.drawImage(Unknown Source)
        at javax.swing.ImageIcon.paintIcon(Unknown Source)
        at javax.swing.plaf.basic.BasicLabelUI.paint(Unknown Source)
        at javax.swing.plaf.ComponentUI.update(Unknown Source)
        at javax.swing.JComponent.paintComponent(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at javax.swing.JComponent.paintChildren(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at javax.swing.JViewport.paint(Unknown Source)
        at javax.swing.JComponent.paintChildren(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at javax.swing.JComponent.paintChildren(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at javax.swing.JComponent.paintChildren(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at javax.swing.JLayeredPane.paint(Unknown Source)
        at javax.swing.JComponent.paintChildren(Unknown Source)
        at javax.swing.JComponent.paintToOffscreen(Unknown Source)
        at javax.swing.BufferStrategyPaintManager.paint(Unknown Source)
        at javax.swing.RepaintManager.paint(Unknown Source)
        at javax.swing.JComponent.paint(Unknown Source)
        at java.awt.GraphicsCallback$PaintCallback.run(Unknown Source)
        at sun.awt.SunGraphicsCallback.runOneComponent(Unknown Source)
        at sun.awt.SunGraphicsCallback.runComponents(Unknown Source)
        at java.awt.Container.paint(Unknown Source)
        at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
        at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
        at javax.swing.RepaintManager.seqPaintDirtyRegions(Unknown Source)
        at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run(Unknown Source)
        at java.awt.event.InvocationEvent.dispatch(Unknown Source)
        at java.awt.EventQueue.dispatchEvent(Unknown Source)
        at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.run(Unknown Source)
</pre><p>
On Mac OS X, the exception is similar:
</p>
<pre class="wiki">Exception in thread "AWT-EventQueue-0" java.lang.ArrayIndexOutOfBoundsException: 42036
        at java.awt.image.DataBufferInt.getElem(DataBufferInt.java:187)
        at java.awt.image.ComponentSampleModel.getDataElements(ComponentSampleModel.java:625)
        at java.awt.image.Raster.getDataElements(Raster.java:1460)
        at sun.awt.image.SunWritableRaster.getDataElements(SunWritableRaster.java:227)
        at java.awt.image.BufferedImage.getRGB(BufferedImage.java:949)
        at apple.awt.OSXOffScreenSurfaceData.syncFromCustom(OSXOffScreenSurfaceData.java:936)
        at apple.awt.CRenderer.doImage(Native Method)
        at apple.awt.OSXSurfaceData.blitImage(OSXSurfaceData.java:1393)
        at apple.awt.CRenderer.blitImage(CRenderer.java:698)
        at apple.awt.CRenderer.copyImage(CRenderer.java:712)
        at apple.awt.CRenderer.copyImage(CRenderer.java:799)
        at sun.java2d.pipe.ValidatePipe.copyImage(ValidatePipe.java:168)
        at sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3163)
        at sun.java2d.SunGraphics2D.drawImage(SunGraphics2D.java:3148)
        at javax.swing.ImageIcon.paintIcon(ImageIcon.java:324)
        at javax.swing.plaf.basic.BasicLabelUI.paint(BasicLabelUI.java:161)
        at apple.laf.AquaLabelUI.paint(AquaLabelUI.java:31)
        at javax.swing.plaf.ComponentUI.update(ComponentUI.java:154)
        at javax.swing.JComponent.paintComponent(JComponent.java:743)
        at javax.swing.JComponent.paint(JComponent.java:1006)
        at javax.swing.JComponent.paintChildren(JComponent.java:843)
        at javax.swing.JComponent.paint(JComponent.java:1015)
        at javax.swing.JViewport.paint(JViewport.java:726)
        at javax.swing.JComponent.paintChildren(JComponent.java:843)
        at javax.swing.JComponent.paint(JComponent.java:1015)
        at javax.swing.JComponent.paintChildren(JComponent.java:843)
        at javax.swing.JComponent.paint(JComponent.java:1015)
        at javax.swing.JComponent.paintChildren(JComponent.java:843)
        at javax.swing.JComponent.paint(JComponent.java:1015)
        at javax.swing.JLayeredPane.paint(JLayeredPane.java:559)
        at javax.swing.JComponent.paintChildren(JComponent.java:843)
        at javax.swing.JComponent.paint(JComponent.java:1015)
        at java.awt.GraphicsCallback$PaintCallback.run(GraphicsCallback.java:34)
        at sun.awt.SunGraphicsCallback.runOneComponent(SunGraphicsCallback.java:60)
        at sun.awt.SunGraphicsCallback.runComponents(SunGraphicsCallback.java:97)
        at java.awt.Container.paint(Container.java:1722)
        at sun.awt.RepaintArea.paintComponent(RepaintArea.java:276)
        at sun.awt.RepaintArea.paint(RepaintArea.java:241)
        at apple.awt.ComponentModel.handleEvent(ComponentModel.java:251)
        at apple.awt.CWindow.handleEvent(CWindow.java:176)
        at java.awt.Component.dispatchEventImpl(Component.java:4126)
        at java.awt.Container.dispatchEventImpl(Container.java:2068)
        at java.awt.Window.dispatchEventImpl(Window.java:1791)
        at java.awt.Component.dispatchEvent(Component.java:3885)
        at java.awt.EventQueue.dispatchEvent(EventQueue.java:463)
        at java.awt.EventDispatchThread.pumpOneEventForHierarchy(EventDispatchThread.java:269)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:190)
        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:184)
        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:176)
        at java.awt.EventDispatchThread.run(EventDispatchThread.java:110)
</pre><p>
Something must have changed in the way we generate BufferedImages.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2008-02-11T12:20:48-06:00 by curtis
                </h3>
                
    <div class="comment searchable">
      
      <p>
I tried it with <a class="changeset" href="https://github.com/openmicroscopy/bioformats/commit/285cab458e" title="2007 Dec 28 release of LOCI Tools
">r3520</a> and the code worked then. If this ticket is still open, I'll narrow it down further later when I have some time.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2008-02-14T09:27:48-06:00 by melissa
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
<a class="changeset" href="https://github.com/openmicroscopy/bioformats/commit/fc2fedd9eb" title="Override openImage(int, int, int, int, int) so that legacy files don't ...">r3689</a>
</p>

    </div>

              </div>
          </div>
        </div>
    </div>
    </div>
  </body>
</html>
