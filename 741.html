<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #741 (SLIMPlugin threshold control doesn't correspond to TRI2)
     â€“ LOCI Software
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="search" href="/trac/software/search" />
        <link rel="prev" href="/trac/software/ticket/740" title="Ticket #740" />
        <link rel="last" href="/trac/software/ticket/822" title="Ticket #822" />
        <link rel="help" href="/trac/software/wiki/TracGuide" />
        <link rel="alternate" href="/trac/software/ticket/741?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="/trac/software/ticket/741?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="/trac/software/ticket/741?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="/trac/software/ticket/742" title="Ticket #742" />
        <link rel="start" href="/trac/software/wiki" />
        <link rel="stylesheet" href="/trac/software/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/trac/software/chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="/trac/software/ticket/1" title="Ticket #1" />
        <link rel="shortcut icon" href="/trac/software/chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="/trac/software/chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/trac/software/search/opensearch" title="Search LOCI Software" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="2969839616cf2456b2b83e68";
    </script>
    <script type="text/javascript" src="/trac/software/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/babel.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/trac.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/search.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/folding.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/resizer.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/software/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 741, escape_newlines: 0}
        $("#comment").autoPreview("/trac/software/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/trac/software/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="/trac/software/chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://loci.wisc.edu/"><img src="http://loci.wisc.edu/loci-logo.png" alt="LOCI" height="98" width="300" /></a>
      </div>
      <form id="search" action="/trac/software/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/trac/software/login">Login</a></li><li><a href="/trac/software/wiki/TracGuide">Help/Guide</a></li><li><a href="/trac/software/about">About Trac</a></li><li><a href="/trac/software/prefs">Preferences</a></li><li class="last"><a href="/trac/software/reset_password">Forgot your password?</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="/trac/software/wiki">Wiki</a></li><li><a href="/trac/software/timeline">Timeline</a></li><li><a href="/trac/software/roadmap">Roadmap</a></li><li><a href="/trac/software/browser">Browse Source</a></li><li class="active"><a href="/trac/software/report">View Tickets</a></li><li class="last"><a href="/trac/software/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="/trac/software/ticket/740" title="Ticket #740">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="/trac/software/ticket/742" title="Ticket #742">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/trac/software/ticket/741">Ticket #741</a>
          <span class="status">(closed defect: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="/trac/software/timeline?from=2012-09-28T14%3A38%3A28-05%3A00&amp;precision=second" title="2012-09-28T14:38:28-05:00 in Timeline">7 years</a> ago</p>
    <p>Last modified <a class="timeline" href="/trac/software/timeline?from=2012-10-05T19%3A54%3A50-05%3A00&amp;precision=second" title="2012-10-05T19:54:50-05:00 in Timeline">7 years</a> ago</p>
  </div>
  <h2 class="summary searchable">SLIMPlugin threshold control doesn't correspond to TRI2</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="/trac/software/query?status=!closed&amp;reporter=aivar">aivar</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="/trac/software/query?status=!closed&amp;owner=aivar">aivar</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/trac/software/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="/trac/software/milestone/slimplugin1.2">slimplugin1.2</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/trac/software/query?status=!closed&amp;component=slim-plugin">slim-plugin</a>
        </td>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/trac/software/query?status=!closed&amp;severity=serious">serious</a>
        </td>
    </tr><tr>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr><tr>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2012-09-28 19:50:51.613930+00:00">
        (last modified by aivar)
        (<a href="/trac/software/ticket/741?action=diff&amp;version=1">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
TRI2's threshold control is available under Window/Pre-processing.  It shows the image intensity log histogram with min/max values and you can specify a min/max percentage or min/max values.  With SLIM Plugin the threshold control is just a photon count, default 100, that does not correspond to the 0..255 gray level values you see when you cursor around the grayscale representation.
</p>
<p>
So, TRI2 lets you specify lower/upper and SP only lower.  The values specified differ so it is difficult to set SP up the same as TRI2.  This means it is difficult to compare fitted images and their histograms.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2012-09-28T14%3A50%3A51-05%3A00&amp;precision=second" title="2012-09-28T14:50:51-05:00 in Timeline">7 years</a> ago by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="/trac/software/ticket/741?action=diff&amp;version=1">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2012-09-28T18%3A17%3A57-05%3A00&amp;precision=second" title="2012-09-28T18:17:57-05:00 in Timeline">7 years</a> ago by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>slimplugin1.2</em> to <em>slimplugin1.1A</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2012-10-04T17%3A23%3A24-05%3A00&amp;precision=second" title="2012-10-04T17:23:24-05:00 in Timeline">7 years</a> ago by aivar
                </h3>
                
    <div class="comment searchable">
      
      <p>
Updated SLIMPlugin to use IJ threshold capabilities, including showing a red mask similar to that in TRI2.  The grayscale image also got updated to a 16-bit image (formerly 8-bit) and has values same as TRI2.  Looks wonderful, except results still don't agree:
</p>
<p>
TRI2
File gpl1.sdt, values are 0.0..642.0, if I threshold 642..642 I still get two pixels.  643..643 makes them go away.  0..642 all pixels are shown; 1..642 only 9 pixels turn red.
</p>
<p>
SLIMPlugin
Same file &amp; values, to get the two pixels set 639..642 (BTW mine are white (255,255,255), TRI2 has gray (56,56,56)).  SP 0 level is the same as 1, looks a lot like TRI2 3 (or maybe 4).  The equivalents of TRI2 0, 1, &amp; 2 levels are unobtainable.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2012-10-04T17%3A29%3A48-05%3A00&amp;precision=second" title="2012-10-04T17:29:48-05:00 in Timeline">7 years</a> ago by aivar
                </h3>
                
    <div class="comment searchable">
      
      <p>
The problem is that IJ 16-bit thresholding works by converting to 8-bit (adding red mask colors to the display LUT).  Solution would be to write my own mask display code.  A slight mitigation of this bug would be to treat 0..642 as a special case that turns off threshold mask.  Might be good enough for beta release.
</p>
<p>
IJ thresholding is opposite from what SP needs anyways, pixels between min and max inclusive are masked.  SP really needs to mask pixels from 0..min and max..maxValue as in TRI2 preprocessing.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2012-10-05T19%3A54%3A50-05%3A00&amp;precision=second" title="2012-10-05T19:54:50-05:00 in Timeline">7 years</a> ago by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Rewrote the thresholding code to use IJ's overlay capability.  This also makes it easier to add a cursor to show which pixel was fitted <a class="closed ticket" href="/trac/software/ticket/752" title="defect: Should show crosshair for fitted pixel (closed: fixed)">#752</a>.
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/trac/software/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/trac/software/ticket/741?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/trac/software/ticket/741?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/trac/software/ticket/741?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/trac/software/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/software/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the LOCI software web site at<br /><a href="http://loci.wisc.edu/software/">http://loci.wisc.edu/software/</a></p>
    </div>
  </body>
</html>