<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #570 (Populate ImageJ's 'origin' metadata)
     – LOCI Software
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="search" href="/trac/software/search" />
        <link rel="prev" href="/trac/software/ticket/569" title="Ticket #569" />
        <link rel="last" href="/trac/software/ticket/822" title="Ticket #822" />
        <link rel="help" href="/trac/software/wiki/TracGuide" />
        <link rel="alternate" href="/trac/software/ticket/570?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="/trac/software/ticket/570?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="/trac/software/ticket/570?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="/trac/software/ticket/571" title="Ticket #571" />
        <link rel="start" href="/trac/software/wiki" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" />
        <link rel="first" href="/trac/software/ticket/1" title="Ticket #1" />
        <link rel="shortcut icon" href="/trac/software/chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="/trac/software/chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/trac/software/search/opensearch" title="Search LOCI Software" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="62b8688a6f3be5b5ca12ab64";
    </script>
    <script type="text/javascript" src="/trac/software/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/babel.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/trac.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/search.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/folding.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/resizer.js"></script><script type="text/javascript" src="/trac/software/chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/software/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 570, escape_newlines: 0}
        $("#comment").autoPreview("/trac/software/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/trac/software/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/trac/software/ticket/570">Ticket #570</a>
          <span class="status">(closed enhancement: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="/trac/software/timeline?from=2010-09-29T20%3A00%3A52-05%3A00&amp;precision=second" title="2010-09-29T20:00:52-05:00 in Timeline">9 years</a> ago</p>
    <p>Last modified <a class="timeline" href="/trac/software/timeline?from=2010-10-08T17%3A15%3A36-05%3A00&amp;precision=second" title="2010-10-08T17:15:36-05:00 in Timeline">9 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Populate ImageJ's 'origin' metadata</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="/trac/software/query?status=!closed&amp;reporter=melissa">melissa</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="/trac/software/query?status=!closed&amp;owner=melissa">melissa</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/trac/software/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="/trac/software/milestone/bio-formats-4.2.1">bio-formats-4.2.1</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/trac/software/query?status=!closed&amp;component=plugins">plugins</a>
        </td>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/trac/software/query?status=!closed&amp;severity=cosmetic">cosmetic</a>
        </td>
    </tr><tr>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
              <a href="/trac/software/query?status=!closed&amp;cc=~curtis">curtis</a>, <a href="/trac/software/query?status=!closed&amp;cc=~dscho">dscho</a>, white@…
        </td>
    </tr><tr>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
The ImageJ import plugin should be populating the '*Origin' fields in ij.measure.Calibration using the values of MetadataRetrieve.getPlanePosition*(...).
</p>
<p>
This can be tested with tiled LSMs (see data/zeiss-lsm/dan/tiled/), but would also be useful for all the other formats that support multiple tiles and/or stage positions.
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-02T12%3A25%3A07-05%3A00&amp;precision=second" title="2010-10-02T12:25:07-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
    <div class="comment searchable">
      
      <p>
(In <a class="changeset" href="/trac/software/changeset/7018" title="Sets the Calibration.*Origin values to equal the stage position (if ...">[7018]</a>) Sets the Calibration.*Origin values to equal the stage position (if present).  See <a class="closed ticket" href="/trac/software/ticket/570" title="enhancement: Populate ImageJ's 'origin' metadata (closed: fixed)">#570</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-02T12%3A35%3A09-05%3A00&amp;precision=second" title="2010-10-02T12:35:09-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
    <div class="comment searchable">
      
      <p>
As noted above, <a class="changeset" href="/trac/software/changeset/7018" title="Sets the Calibration.*Origin values to equal the stage position (if ...">r7018</a> should populate the origin metadata.  However, the tiled LSM files are not reporting the correct position information, so this is not completely fixed yet.
</p>
<p>
Also, we need to decide whether or not the changes in <a class="changeset" href="/trac/software/changeset/7018" title="Sets the Calibration.*Origin values to equal the stage position (if ...">r7018</a> actually reflect how we want to use Calibration.*Origin.  What we are doing now is to set the origin to be the stage position - so when you select "Image &gt; Properties", the "Origin" field shows the stage (or tile) position in pixels.  
</p>
<p>
However, if you mouse over the image, you will notice that the X, Y, and Z coordinates look quite incorrect.  The solution would be to set the origin such that the XYZ coordinate of the upper-left-most pixel in the image is the stage or tile position.  This would mean that the coordinates would be correct if you mouse over the image, but the "Origin" field in "Image &gt; Properties" would not make much sense.
</p>
<p>
If anyone has a preference, I would be very glad to hear it.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-06T18%3A07%3A09-05%3A00&amp;precision=second" title="2010-10-06T18:07:09-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
    <div class="comment searchable">
      
      <p>
(In <a class="changeset" href="/trac/software/changeset/7040" title="Progress on reading position data from LSM files.  See #576, see #570.
">[7040]</a>) Progress on reading position data from LSM files.  See <a class="closed ticket" href="/trac/software/ticket/576" title="enhancement: Improve Zeiss LSM stage/tile position parsing (closed: fixed)">#576</a>, see <a class="closed ticket" href="/trac/software/ticket/570" title="enhancement: Populate ImageJ's 'origin' metadata (closed: fixed)">#570</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-07T12%3A03%3A34-05%3A00&amp;precision=second" title="2010-10-07T12:03:34-05:00 in Timeline">9 years</a> ago by curtis
                </h3>
                
    <div class="comment searchable">
      
      <p>
Hmm, it sounds like the "Origin" metadata is not used exactly how I thought. So I'm not actually sure it's the best place to populate the stage positions after all.
</p>
<p>
Wayne recently added a new macro function to ImageJ called getInfo that returns the value corresponding to a specific field in the Image Info window (Image &gt; Show Info...).
</p>
<p>
So, perhaps we should simply populate the Info window with some of the key standardized fields according to a standard naming convention (ideally matching the OME schema). Then we can avoid using Origin for something other than its originally intended use.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-08T16%3A23%3A17-05%3A00&amp;precision=second" title="2010-10-08T16:23:17-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
    <div class="comment searchable">
      
      <p>
(In <a class="changeset" href="/trac/software/changeset/7054" title="Reverted r7018, see #570.
">[7054]</a>) Reverted <a class="changeset" href="/trac/software/changeset/7018" title="Sets the Calibration.*Origin values to equal the stage position (if ...">r7018</a>, see <a class="closed ticket" href="/trac/software/ticket/570" title="enhancement: Populate ImageJ's 'origin' metadata (closed: fixed)">#570</a>.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-08T17%3A04%3A42-05%3A00&amp;precision=second" title="2010-10-08T17:04:42-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
    <div class="comment searchable">
      
      <p>
(In <a class="changeset" href="/trac/software/changeset/7055" title="Standardized storage of stage positions in the original metadata ...">[7055]</a>) Standardized storage of stage positions in the original metadata hashtable.  See <a class="closed ticket" href="/trac/software/ticket/570" title="enhancement: Populate ImageJ's 'origin' metadata (closed: fixed)">#570</a>.
</p>
<p>
All readers that store stage positions in Plane.PositionX or Plane.PositionY will now also store them in the original metadata hashtable as "X position for position #n" and "Y position for position #n", where n is the series number indexed from 1.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/trac/software/timeline?from=2010-10-08T17%3A15%3A36-05%3A00&amp;precision=second" title="2010-10-08T17:15:36-05:00 in Timeline">9 years</a> ago by melissa
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Closing this ticket, as you can now retrieve the stage positions from the original metadata hashtable and the OME-XML window.  See <a class="closed ticket" href="/trac/software/ticket/582" title="task: Consider standarizing some original metadata keys (closed: fixed)">#582</a> for further progress on standardized original metadata keys, or if you don't like the keys introduced in <a class="changeset" href="/trac/software/changeset/7055" title="Standardized storage of stage positions in the original metadata ...">r7055</a> (they were chosen for compatibility with what NativeND2Reader uses).
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/trac/software/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/trac/software/ticket/570?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/trac/software/ticket/570?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/trac/software/ticket/570?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/trac/software/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/software/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the LOCI software web site at<br /><a href="http://loci.wisc.edu/software/">http://loci.wisc.edu/software/</a></p>
    </div>
  </body>
</html>
